<link rel=import href=../bower_components/polymer/polymer-element.html>
<link rel=import href=../bower_components/iron-ajax/iron-ajax.html>
<link rel=import href=../bower_components/iron-pages/iron-pages.html>
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-dialog-scrollable/paper-dialog-scrollable.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tab.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">

<link rel=import href=shared-styles.html>

<dom-module id=book-picker>
    <template>
        <style include=shared-styles>
            :host {
                display: block;
                padding: 5px;
                --paper-tabs-selection-bar-color: var(--app-primary-color);
                --paper-tab-ink: var(--accent-color);
            }
            .books {
                display: flex;
                justify-content: space-between;
                flex-wrap: wrap;
            }
            .btn {
                margin: 8px;
            }
        </style>

        <paper-dialog id="modal" modal>
            <h1>Select Book ({{book}})</h1>
            <paper-tabs selected={{selected}}>
                <paper-tab>Old Testament</paper-tab>
                <paper-tab>New Testament</paper-tab>
            </paper-tabs>
            <paper-dialog-scrollable>
                <iron-pages selected={{selected}}>
                    <div class="books">
                        <template is="dom-repeat" items="{{oldT}}">
                            <paper-button class="btn" on-tap="select">{{item}}</paper-button>
                        </template>
                    </div>
                    <div class="books">
                        <template is="dom-repeat" items="{{newT}}">
                            <paper-button class="btn" on-tap="select">{{item}}</paper-button>
                        </template>
                    </div>
                </iron-pages>
            </paper-dialog-scrollable>
            <div class="buttons">
                <paper-button dialog-confirm autofocus>Cancel</paper-button>
            </div>
        </paper-dialog>
        <iron-ajax auto url="/api/books" on-response="onBooks"></iron-ajax>

    </template>

    <script>
      class BookPicker extends Polymer.Element {
        static get is() { return 'book-picker'; }
        static get properties() {
          return {
            selected: {
              type: Number,
              value: 0
            },
            oldT: {
              type: Array
            },
            newT: {
              type: Array
            },
            book: {
              type: String,
              notify: true
            },
            chapter: {
              type: Number,
              notify: true
            }
          }
        }
        open() {
          this.$.modal.open();
        }
        onBooks(e) {
          this.oldT = e.detail.response['old'];
          this.newT = e.detail.response['new'];
        }
        select(e) {
          var book = e.model.get('item');
          console.log(book);
          this.book = book;
        }
      }

      window.customElements.define(BookPicker.is, BookPicker);
    </script>
</dom-module>
